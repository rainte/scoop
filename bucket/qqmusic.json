{
    "version": "21.2.0",
    "description": "音乐播放器 QQMusic",
    "homepage": "https://y.qq.com",
    "url": "https://webcdn.m.qq.com/spcmgr/download/#/dl.7z",
    "hash": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
    "installer": {
        "script": [
            "Import-Module $bucketsdir\\rainte\\scripts\\qqmusic\\AppsUtils.psm1",
            "Mount-ExternalRuntimeData -Source \"$persist_dir\\appdata\" -Target \"$env:APPDATA\\Tencent\\QQMusic\"",
            "Remove-Module -Name AppsUtils"
        ]
    },
    "bin": "QQMusic.exe",
    "shortcuts": [
        [
            "QQMusic.exe",
            "QQ音乐"
        ]
    ],
    "post_install": "Copy-Item \"$dir\\QQMusic.tpc\" \"$dir\\instok\"",
    "uninstaller": {
        "script": [
            "Import-Module $bucketsdir\\rainte\\scripts\\qqmusic\\AppsUtils.psm1",
            "Dismount-ExternalRuntimeData -Target \"$env:APPDATA\\Tencent\\QQMusic\"",
            "Remove-Module -Name AppsUtils"
        ]
    },
    "checkver": {
        "script": [
            "$res = Invoke-WebRequest -UseBasicParsing -Uri 'https://luban.m.qq.com/api/public/software-manager/softwareProxy' -Body 'cmdid=3318&jprxReq[req][soft_id_list]=10' -Method 'POST'",
            "$content = $res.Content | ConvertFrom-Json",
            "$verName = $content.resp.soft_list[0].ver_name",
            "$fileName = $content.resp.soft_list[0].file_name",
            "Write-Output \"$verName|$fileName\""
        ],
        "regex": "(?<version>[\\d.]+)(?<build>\\.[\\d]+)|(?<id>.*?)"
    },
    "autoupdate": {
        "url": "https://webcdn.m.qq.com/spcmgr/download/$matchId#/dl.7z",
        "hash": {
            "url": "https://raw.githubusercontent.com/microsoft/winget-pkgs/master/manifests/t/Tencent/QQMusic/$version/Tencent.QQMusic.installer.yaml",
            "regex": "$sha256"
        }
    }
}
